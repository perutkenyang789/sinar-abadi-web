{% extends 'base.html' %}
{% load static %}
{% block content %}
{% include 'navbar.html' %}

<div class="flex items-center justify-center h-screen bg-white flex-col gap-4">
    <img src="{% static 'image/small-logo.png' %}" alt="Sinar Abadi Logo" class="h-40 w-auto"/>
    <div class="text-center">
        <h1 class="text-4xl font-bold text-gray-800">Selamat Datang di {{ company }}</h1>
        <br>
        <h4 class="text-xl text-gray-600">Didirikan oleh {{ owner_name }} dari {{ owner_class }}</h4>
        <br>
        <!-- Add username and last login time here -->
        <p class="text-lg text-gray-500">Hello there, {{ user.username }}</p>
        <p class="text-sm text-gray-400">Last login: {{ user.last_login|date:"d F Y H:i" }}</p>
    </div>
</div>

<div class="flex justify-center h-screen gap-4 p-6">
    <div id="product_cards"></div>
</div>

<script>
    async function getProducts(){
        return fetch("{% url 'main:show_json' %}").then((res) => res.json())
    }

    async function refreshProducts() {
        document.getElementById("product_cards").innerHTML = "";
        document.getElementById("product_cards").className = "";
        const store_products = await getProducts();
        let htmlString = "";
        let classNameString = "";

        if (store_products.length === 0){
            classNameString = "flex flex-col items-center justify-center p-6";
            htmlString = `
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 122.88 92.26" style="enable-background:new 0 0 122.88 92.26" xml:space="preserve">
                    <style type="text/css">.st0{fill-rule:evenodd;clip-rule:evenodd;}</style>
                    <g><path class="st0" d="..."/></g>
                </svg>
                <p class="text-center text-gray-600 mt-4">There is no product data in Toko SInar Abadi.</p>
            `;
        }

        else {
            classNameString = "columns-1 sm:columns-2 lg:columns-3 gap-6 space-y-6 w-full";
            store_products.forEach(product => {
                htmlString += `
                <div class="relative break-inside-avoid">
                    <!-- Icons on Top -->

                    
                    <!-- Product Card -->
                    <div class="relative top-5 bg-indigo-100 shadow-md rounded-lg mb-6 break-inside-avoid flex flex-col border-2 border-indigo-300 transition-transform duration-300 hover:scale-105"> <!-- Removed rotate and added scale on hover -->
                        
                        <!-- Product Header -->
                        <div class="bg-indigo-200 text-gray-800 p-4 rounded-t-lg border-b-2 border-indigo-300">
                            <h3 class="font-bold text-xl mb-2">${product.fields.name}</h3>
                            <p class="text-gray-600">${product.fields.price } IDR</p>
                        </div>
                        
                        <!-- Product Description -->
                        <div class="p-4">
                            <p class="font-semibold text-lg mb-2">Description</p> 
                            <p class="text-gray-700 mb-2">
                                <span class="bg-[linear-gradient(to_bottom,transparent_0%,transparent_calc(100%_-_1px),#CDC1FF_calc(100%_-_1px))] bg-[length:100%_1.5rem] pb-1">${product.fields.description}</span>
                            </p>
                        </div>
                        
                        <!-- Product Color -->
                        <div class="p-4">
                            <p class="font-semibold text-lg mb-2">Color</p> 
                            <p class="text-gray-700 mb-2">
                                <span class="bg-[linear-gradient(to_bottom,transparent_0%,transparent_calc(100%_-_1px),#CDC1FF_calc(100%_-_1px))] bg-[length:100%_1.5rem] pb-1">${product.fields.color}</span>
                            </p>
                        </div>
                    
                        <div class="flex justify-center space-x-4 mt-6 p-4"> <!-- Centered and spaced evenly -->
                            <a href="/update-product/${product.pk}" class="flex items-center space-x-2 text-white bg-[#FEE440] hover:bg-yellow-400 px-4 py-2 rounded-lg transition duration-300 shadow-md"> <!-- Added hover effect -->
                                <!-- New Edit Icon -->
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 17l-5 5m5-5l5 5M12 9v4m0 4v-4M21 12v-1a9 9 0 10-9 9h1M12 12V4m0 0h4m-4 0H8" />
                                </svg>
                                <span>Edit</span>
                            </a>
                        
                            <a href="/delete-product/${product.pk}" class="flex items-center space-x-2 text-white bg-[#FF865E] hover:bg-red-500 px-4 py-2 rounded-lg transition duration-300 shadow-md"> <!-- Added hover effect -->
                                <!-- New Delete Icon -->
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                                <span>Delete</span>
                            </a>
                        </div>
                    </div>
                </div>
                `
            });
        }
        document.getElementById("product_cards").innerHTML = htmlString;
        document.getElementById("product_cards").className = classNameString;
    }
refreshProducts();
</script>
{% endblock content %}